# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

A Next.js 15 web application that calculates retirement planning using the "Die With Zero" philosophy - determining exactly how much you need to earn to spend all your money by life expectancy. Uses compound interest formulas to project wealth trajectory through accumulation and decumulation phases.

## Development Commands

```bash
# Install dependencies
npm install

# Run development server with Turbopack
npm run dev

# Build for production with Turbopack
npm run build

# Start production server
npm start
```

## Architecture

### Core Financial Calculation Engine (`lib/calculations.ts`)

The heart of the application. All financial calculations use:

- **Effective monthly rate**: Converted from annual ROI using `(1 + annualRate)^(1/12) - 1` for accurate compounding
- **Present/Future value formulas**: Standard time value of money calculations
- **Annuity formulas**: For retirement cash flow streams

Key function: `calculateDieWithZero()` returns:

- Monthly/yearly/total earnings needed
- Year-by-year wealth projection array
- Achievability status and messages

The wealth chart is generated by month-by-month simulation (not yearly) to ensure precision, then sampled at integer ages for display.

### Component Structure

- **`app/page.tsx`**: Entry point, renders Calculator component
- **`components/Calculator.tsx`**: Main UI with input form and results display. Manages state for inputs and calculation results. Client component.
- **`components/WealthChart.tsx`**: Custom SVG chart visualization showing wealth accumulation and decumulation phases. Client component.
- **`app/layout.tsx`**: Root layout with fonts (Geist Sans, Geist Mono) and metadata

### Calculation Flow

1. User inputs â†’ `CalculatorInputs` interface
2. `calculateDieWithZero()` computes:
   - Exact current age (years + months/12)
   - Months until retirement and in retirement
   - Wealth needed at retirement (PV of retirement expenses minus income)
   - Future value of current savings
   - Monthly savings needed to bridge the gap
3. Month-by-month simulation generates wealth trajectory
4. Results displayed with formatted currency and interactive SVG chart

### Edge Cases Handled

- Already have enough savings (no additional earnings needed)
- At or past retirement age (requires lump sum, monthly plan impossible)
- Zero or near-zero ROI rate (uses linear formula instead of compound)
- Unrealistic income requirements (marked as not achievable)

## Technology Stack

- **Next.js 15** with App Router and Turbopack
- **React 19** (client components for interactivity)
- **TypeScript** with strict types
- **Tailwind CSS 4** with @tailwindcss/postcss
- **Custom SVG charts** (no external charting library)

## Key Patterns

- All monetary calculations in `lib/calculations.ts` are pure functions
- Client components use `"use client"` directive
- State management via React useState (no external state library)
- Responsive design with Tailwind's gradient backgrounds and glassmorphism effects
